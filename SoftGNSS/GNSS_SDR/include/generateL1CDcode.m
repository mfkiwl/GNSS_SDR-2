function L1CDcode = generateL1CDcode(PRN)
% generateL1CDcode.m generates one of the 32 GPS satellite L1CD codes.
%
% L1CDcode = generateL1CDcode(PRN)
%
%   Inputs:
%       PRN         - PRN number of the sequence.
%
%   Outputs:
%       L1CDcode    - a vector containing the desired L1CD code sequence 
%                   (chips).  
%--------------------------------------------------------------------------
%This program is free software; you can redistribute it and/or
%modify it under the terms of the GNU General Public License
%as published by the Free Software Foundation; either version 2
%of the License, or (at your option) any later version.
%
%This program is distributed in the hope that it will be useful,
%but WITHOUT ANY WARRANTY; without even the implied warranty of
%MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
%GNU General Public License for more details.
%
%You should have received a copy of the GNU General Public License
%along with this program; if not, write to the Free Software
%Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301,
%USA.
%--------------------------------------------------------------------------

%--- Make the weil and insert array. The code depends on the PRN number -------
weil=[ %/* Weil Index */
    5097, 5110, 5079, 4403, 4121, 5043, 5042, 5104, 4940, 5035, ...%/*   1- 10 */
    4372, 5064, 5084, 5048, 4950, 5019, 5076, 3736, 4993, 5060, ...%/*  11- 20 */
    5061, 5096, 4983, 4783, 4991, 4815, 4443, 4769, 4879, 4894, ...%/*  21- 30 */
    4985, 5056, 4921, 5036, 4812, 4838, 4855, 4904, 4753, 4483, ...%/*  31- 40 */
    4942, 4813, 4957, 4618, 4669, 4969, 5031, 5038, 4740, 4073, ...%/*  41- 50 */
    4843, 4979, 4867, 4964, 5025, 4579, 4390, 4763, 4612, 4784, ...%/*  51- 60 */
    3716, 4703, 4851, 4955, 5018, 4642, 4840, 4961, 4263, 5011, ...%/*  61- 70 */
    4922, 4317, 3636, 4884, 5041, 4912, 4504, 4617, 4633, 4566, ...%/*  71- 80 */
    4702, 4758, 4860, 3962, 4882, 4467, 4730, 4910, 4684, 4908, ...%/*  81- 90 */
    4759, 4880, 4095, 4971, 4873, 4561, 4588, 4773, 4997, 4583, ...%/*  91-100 */
    4900, 4574, 4629, 4676, 4181, 5057, 4944, 4401, 4586, 4699, ...%/* 101-110 */
    3676, 4387, 4866, 4926, 4657, 4477, 4359, 4673, 4258, 4447, ...%/* 111-120 */
    4570, 4486, 4362, 4481, 4322, 4668, 3967, 4374, 4553, 4641, ...%/* 121-130 */
    4215, 3853, 4787, 4266, 4199, 4545, 4208, 4485, 3714, 4407, ...%/* 131-140 */
    4182, 4203, 3788, 4471, 4691, 4281, 4410, 3953, 3465, 4801, ...%/* 141-150 */
    4278, 4546, 3779, 4115, 4193, 3372, 3786, 3491, 3812, 3594, ...%/* 151-160 */
    4028, 3652, 4224, 4334, 3245, 3921, 3840, 3514, 2922, 4227, ...%/* 161-170 */
    3376, 3560, 4989, 4756, 4624, 4446, 4174, 4551, 3972, 4399, ...%/* 171-180 */
    4562, 3133, 4157, 5053, 4536, 5067, 3905, 3721, 3787, 4674, ...%/* 181-190 */
    3436, 2673, 4834, 4456, 4056, 3804, 3672, 4205, 3348, 4152, ...%/* 191-200 */
    3883, 3473, 3669, 3455, 2318, 2945, 2947, 3220, 4052, 2953  ...%/* 201-210 */
    ];
insert=[ %/* Insertion Index */
    181,  359,   72, 1110, 1480, 5034, 4622,    1, 4547,  826, ...%/*   1- 10 */
    6284, 4195,  368,    1, 4796,  523,  151,  713, 9850, 5734, ...%/*  11- 20 */
    34, 6142,  190,  644,  467, 5384,  801,  594, 4450, 9437, ...%/*  21- 30 */
    4307, 5906,  378, 9448, 9432, 5849, 5547, 9546, 9132,  403, ...%/*  31- 40 */
    3766,    3,  684, 9711,  333, 6124,10216, 4251, 9893, 9884, ...%/*  41- 50 */
    4627, 4449, 9798,  985, 4272,  126,10024,  434, 1029,  561, ...%/*  51- 60 */
    289,  638, 4353, 9899, 4629,  669, 4378, 4528, 9718, 5485, ...%/*  61- 70 */
    6222,  672, 1275, 6083, 5264,10167, 1085,  194, 5012, 4938, ...%/*  71- 80 */
    9356, 5057,  866,    2,  204, 9808, 4365,  162,  367,  201, ...%/*  81- 90 */
    18,  251,10167,   21,  685,   92, 1057,    3, 5756,   14, ...%/*  91-100 */
    9979, 9569,  515,  753, 1181, 9442,  669, 4834,  541, 9933, ...%/* 101-110 */
    6683, 4828, 9710,10170, 9629,  260,   86, 5544,  923,  257, ...%/* 111-120 */
    507, 4572, 4491,  341,  130,   79, 1142,  448,  875,  555, ...%/* 121-130 */
    1272, 5198, 9529, 4459,10019, 9353, 9780,  375,  503, 4507, ...%/* 131-140 */
    875, 1246,    1, 4534,    8, 9549, 6240,   22, 5652,10069, ...%/* 141-150 */
    4796, 4980,   27,   90, 9788,  715, 9720,  301, 5450, 5215, ...%/* 151-160 */
    13, 1147, 4855, 1190, 1267, 1302,    1, 5007,  549,  368, ...%/* 161-170 */
    6300, 5658, 4302,  851, 4353, 9618, 9652, 1232,  109,10174, ...%/* 171-180 */
    6178, 1851, 1299,  325,10206, 9968,10191, 5438,10080,  219, ...%/* 181-190 */
    758, 2140, 9753, 4799,10126,  241, 1245, 1274, 1456, 9967, ...%/* 191-200 */
    235,  512, 1078, 1078,  953, 5647,  669, 1311, 5827,   15  ...%/* 201-210 */
    ];

insertbit=[-1,1,1,-1,1,-1,-1];
weilcode = ones(1,10223);
%--- Pick weil code and insert bit index for the given PRN number ----------------------------
w = weil(PRN);
p = insert(PRN);

%--- Generate Legendre sequence for L1CD Code -----------------------------------------------------
legendre=ones(1,10223);
for i = 1:10222
    legendre(mod(i^2,10223)+1)=-1;
end
%legendre(1)=1;

for i = 0:10222
   ind=mod(i+w,10223); 
   weilcode(i+1) = -legendre(i+1)*legendre(ind+1);
end

%--- Insert bits ---
L1CDcode = [weilcode(1:p), insertbit, weilcode(p+1:10223)];
