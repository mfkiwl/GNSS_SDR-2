function L1CPcode = generateL1CPcode(PRN)
% generateL1CPcode.m generates one of the 32 GPS satellite L1CP codes.
%
% L1CPcode = generateL1CPcode(PRN)
%
%   Inputs:
%       PRN         - PRN number of the sequence.
%
%   Outputs:
%       L1CPcode    - a vector containing the desired L1CP code sequence 
%                   (chips).  
%--------------------------------------------------------------------------
%This program is free software; you can redistribute it and/or
%modify it under the terms of the GNU General Public License
%as published by the Free Software Foundation; either version 2
%of the License, or (at your option) any later version.
%
%This program is distributed in the hope that it will be useful,
%but WITHOUT ANY WARRANTY; without even the implied warranty of
%MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
%GNU General Public License for more details.
%
%You should have received a copy of the GNU General Public License
%along with this program; if not, write to the Free Software
%Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301,
%USA.
%--------------------------------------------------------------------------

%--- Make the weil and insert array. The code depends on the PRN number -------
weil=[ %/* Weil Index */
       5111, 5109, 5108, 5106, 5103, 5101, 5100, 5098, 5095, 5094, ...%/*   1- 10 */
       5093, 5091, 5090, 5081, 5080, 5069, 5068, 5054, 5044, 5027, ...%/*  11- 20 */
       5026, 5014, 5004, 4980, 4915, 4909, 4893, 4885, 4832, 4824, ...%/*  21- 30 */
       4591, 3706, 5092, 4986, 4965, 4920, 4917, 4858, 4847, 4790, ...%/*  31- 40 */
       4770, 4318, 4126, 3961, 3790, 4911, 4881, 4827, 4795, 4789, ...%/*  41- 50 */
       4725, 4675, 4539, 4535, 4458, 4197, 4096, 3484, 3481, 3393, ...%/*  51- 60 */
       3175, 2360, 1852, 5065, 5063, 5055, 5012, 4981, 4952, 4934, ...%/*  61- 70 */
       4932, 4786, 4762, 4640, 4601, 4563, 4388, 3820, 3687, 5052, ...%/*  71- 80 */
       5051, 5047, 5039, 5015, 5005, 4984, 4975, 4974, 4972, 4962, ...%/*  81- 90 */
       4913, 4907, 4903, 4833, 4778, 4721, 4661, 4660, 4655, 4623, ...%/*  91-100 */
       4590, 4548, 4461, 4442, 4347, 4259, 4256, 4166, 4155, 4109, ...%/* 101-110 */
       4100, 4023, 3998, 3979, 3903, 3568, 5088, 5050, 5020, 4990, ...%/* 111-120 */
       4982, 4966, 4949, 4947, 4937, 4935, 4906, 4901, 4872, 4865, ...%/* 121-130 */
       4863, 4818, 4785, 4781, 4776, 4775, 4754, 4696, 4690, 4658, ...%/* 131-140 */
       4607, 4599, 4596, 4530, 4524, 4451, 4441, 4396, 4340, 4335, ...%/* 141-150 */
       4296, 4267, 4168, 4149, 4097, 4061, 3989, 3966, 3789, 3775, ...%/* 151-160 */
       3622, 3523, 3515, 3492, 3345, 3235, 3169, 3157, 3082, 3072, ...%/* 161-170 */
       3032, 3030, 4582, 4595, 4068, 4871, 4514, 4439, 4122, 4948, ...%/* 171-180 */
       4774, 3923, 3411, 4745, 4195, 4897, 3047, 4185, 4354, 5077, ...%/* 181-190 */
       4042, 2111, 4311, 5024, 4352, 4678, 5034, 5085, 3646, 4868, ...%/* 191-200 */
       3668, 4211, 2883, 2850, 2815, 2542, 2492, 2376, 2036, 1920  ...%/* 201-210 */    
       ];
insert=[ %/* Insertion Index */
        412,  161,    1,  303,  207, 4971, 4496,    5, 4557,  485, ...%/*   1- 10 */
        253, 4676,    1,   66, 4485,  282,  193, 5211,  729, 4848, ...%/*  11- 20 */
        982, 5955, 9805,  670,  464,   29,  429,  394,  616, 9457, ...%/*  21- 30 */
       4429, 4771,  365, 9705, 9489, 4193, 9947,  824,  864,  347, ...%/*  31- 40 */
        677, 6544, 6312, 9804,  278, 9461,  444, 4839, 4144, 9875, ...%/*  41- 50 */
        197, 1156, 4674,10035, 4504,    5, 9937,  430,    5,  355, ...%/*  51- 60 */
        909, 1622, 6284, 9429,   77,  932, 5973,  377,10000,  951, ...%/*  61- 70 */
       6212,  686, 9352, 5999, 9912, 9620,  635, 4951, 5453, 4658, ...%/*  71- 80 */
       4800,   59,  318,  571,  565, 9947, 4654,  148, 3929,  293, ...%/*  81- 90 */
        178,10142, 9683,  137,  565,   35, 5949,    2, 5982,  825, ...%/*  91-100 */
       9614, 9790, 5613,  764,  660, 4870, 4950, 4881, 1151, 9977, ...%/* 101-110 */
       5122,10074, 4832,   77, 4698, 1002, 5549, 9606, 9228,  604, ...%/* 111-120 */
       4678, 4854, 4122, 9471, 5026,  272, 1027,  317,  691,  509, ...%/* 121-130 */
       9708, 5033, 9938, 4314,10140, 4790, 9823, 6093,  469, 1215, ...%/* 131-140 */
        799,  756, 9994, 4843, 5271, 9661, 6255, 5203,  203,10070, ...%/* 141-150 */
         30,  103, 5692,   32, 9826,   76,   59, 6831,  958, 1471, ...%/* 151-160 */
      10070,  553, 5487,   55,  208,  645, 5268, 1873,  427,  367, ...%/* 161-170 */
       1404, 5652,    5,  368,  451, 9595, 1030, 1324,  692, 9819, ...%/* 171-180 */
       4520, 9911,  278,  642, 6330, 5508, 1872, 5445,10131,  422, ...%/* 181-190 */
       4918,  787, 9864, 9753, 9859,  328,    1, 4733,  164,  135, ...%/* 191-200 */
        174,  132,  538,  176,  198,  595,  574,  321,  596,  491  ...%/* 201-210 */   
        ];

insertbit=[-1,1,1,-1,1,-1,-1];
weilcode = ones(1,10223);
%--- Pick weil code and insert bit index for the given PRN number ----------------------------
w = weil(PRN);
p = insert(PRN);

%--- Generate Legendre sequence for L1CP Code -----------------------------------------------------
legendre=ones(1,10223);
for i = 1:10222
    legendre(mod(i^2,10223)+1)=-1;
end
%legendre(1)=1;

for i = 0:10222
   ind=mod(i+w,10223); 
   weilcode(i+1) = -legendre(i+1)*legendre(ind+1);
end

%--- Insert bits ---
L1CPcode = [weilcode(1:p), insertbit, weilcode(p+1:10223)];
